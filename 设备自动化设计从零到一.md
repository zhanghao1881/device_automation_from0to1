# 设备自动化设计从0到1

>Author: LiWei
>
>Created: 2016-11-08

[TOC]

##前言

​	作为一线教师和机器人创新实验室指导老师及一线项目参与者，作者深知大学各专业间的隔阂造成了产品总体设计上人才的缺失，导致国内整体设计水平低下，原因分析如下：

​	一个典型的机电一体化产品不可避免的包含：**机械结构设计**、**控制系统设计**、**软件设计**、**外观设计**等。

1. 机械结构设计等必然是要求机械相关专业的人来完成，但问题在于机械专业课程繁重，**电子电工学**、**程序设计**等犹如走马观花，平时缺少兴趣和足够的练习时间，导致不足百分之一的学生能够在软硬件设计上达到能够设计的程度。机械设计是一个学习周期非常长的领域，入门看似容易，实则非常困难，需要非常多的经验进行铺垫，导致虽然大学有机电工程等看似和机械挂靠很紧密的专业，但实际上**机械设计方向除了存粹的机制专业外，其它专业几乎不可能完成相关工作**。当然如果其它专业学生自学完全部机制方面课程也应该算是机制的学生了。
2. 自动化、机电相关专业学生控制系统设计为本行，稍加兴趣和勤奋进行设计应该不难，但是大学专业可能多半仅限于八位单片机系统设计，教材又是重复了若干年的老掉牙的读物，程序设计几乎仅仅是能够工作而已，很少会顾及代码格式及运行效率的问题，更鲜有稍大规模系统设计经验的学习，所以实际上代码能写的好的学生寥寥无几。
3. 计算机专业的学生理所应当代码应该写的很好，实则不然，笔者看过很多数据统计，普通本科院校几乎百分之九十的计算机专业毕业学生会从事前端开发，像核心课程《操作系统》，《编译原理》能学的好的学生也同样少之又少，要是跟硬件挂钩，更是全民公敌。

   ​	例子多的数不胜数，专业之间的隔阂程度如此之大令人吃惊，因为对其它专业的不了解，以至于会深刻的影响到产品设计时的团队协作。一个好的机电产品，必然是要各方面精益求精，协同设计，而不是各个部分暴力的拼接。所以笔者一直觉得十分有必要产生一门课程，给低年级学生以指导，让其能够快速的对以后可能有影响的相关专业进行必要的了解，只要方向对了，以后自己在根据自己喜好进行一些侧重，势必会对自己今后工作上给予很大的帮助。

   ​	之前提到机械需要较多经验，所以建议机械的东西还是机制的人来做，所以机械方向的东西我就不谈，外观的东西除了在极限设计的情况下，一般来讲跟产品功能的耦合度也较低，所以直接由工业设计相关专业人员完成即可。剩下的就是控制和代码的问题了，所以本内容适用范围为：有兴趣了解机电产品设计整个流程的初级人员。具体的来讲，机械相关学生适合全文通读，自动化相关学生可以直接看提高篇，计算机相关学生可以侧重看看初级篇和中级篇。

   ​	本教程非常基础，初期规划了8个课时，目的在于抛砖引玉，给由兴趣的学生以指引。整个内容完全共享，托管在github上，地址为：https://github.com/winxos/device_automation_from0to1 ，如有任何疑问或建议，或者内容的添加等，欢迎到Issues提交，希望大家一起来分享知识，给新人创造更好的学习环境。

## 初级篇

### 原理图

原理图，是表示电路板上各器件之间连接关系的图表。

![51mini](.\images\51mini.jpg)

### PCB图

PCB图详细描绘了电路板的走线，元件的尺寸及位置等，PCB图可以直接发给厂家进行电路板生产。

![51pcb](.\images\51pcb.jpg)

对于常见的原理图和PCB图目前最常用的软件为 **Altium Designer**。

### PCB生产过程

PCB制作方法主要有热转印法，感光湿膜法，感光干膜法。详细的生产工艺大家自行搜索解决，感光干膜+氯化铁是自己手工制作的最佳首选，大致上分为几个步骤：

- #### 打印pcb至热转印纸

![hot_trans](.\images\hot_trans.jpg)

- #### 转印至铜板

![hoter](.\images\hoter.png)

![coper](.\images\coper.jpg)

- #### 腐蚀

![pcb_make](.\images\pcb_make.jpg)

- #### 清洗及钻孔

![coper2](.\images\coper2.jpg)

当然，工业上面工艺要复杂很多，才能做出像下面的效果。

![arduino_uno](.\images\arduino_uno.png)

在小批量生产的时候，我们只需要将PCB文件发给制造厂商，便能做出像上面一样的电路板，这个过程叫打样。厂家推荐深圳嘉立创，可以自助下单，打样质量高，速度快。

### 芯片封装

所谓封装是指安装半导体集成电路芯片用的外壳，它不仅起着安放、固定、密封、保护芯片和增强导热性能的作用，而且还是沟通芯片内部世界与外部电路的桥梁--芯片上的接点用导线连接到封装外壳的引脚上，这些引脚又通过印刷电路板上的导线与其他器件建立连接。

常用的芯片封装形式有：

#### DIP双列直插式 (Dual In-LINE PACKAGE)

绝大多数中小规模集成电路(IC)均采用这种封装形式，其引脚数一般不超过100个。采用DIP封装的CPU芯片有两排引脚，需要插入到具有DIP结构的芯片插座上。

![dip](.\images\dip.jpg)

#### QFP塑料方型扁平式 (Plastic Quad Flat PACKAGE)

芯片引脚之间距离很小，管脚很细，一般大规模或超大型集成电路都采用这种封装形式，其引脚数一般在100个以上。用这种形式封装的芯片必须采用贴片机将芯片与主板焊接起来。

![qfp](.\images\qfp.jpg)

#### PGA插针网格式 (Pin Grid Array PACKAGE)

芯片的内外有多个方阵形的插针，每个方阵形插针沿芯片的四周间隔一定距离排列。根据引脚数目的多少，可以围成2-5圈。安装时，将芯片插入专门的PGA插座。

![pga](.\images\pga.jpg)

#### BGA球栅阵列式 (BALL Grid Array PACKAGE)

现今大多数的高脚数芯片（如图形芯片与芯片组等）皆转而使用BGA(BALL Grid Array PACKAGE)封装技术。BGA一出现便成为CPU、主板上南/北桥芯片等高密度、高性能、多引脚封装的最佳选择。

![bga](.\images\bga.jpg)

还有很多各式各样的封装形式，详情大家可以自行搜索了解。

随着集成度的增加，封装形式也发生着很大的变化，对于一般机电产品来讲，DIP和QFP形式的封装是使用最多的。

### Arduino入门

#### Arduino简介

Massimo Banzi 之前是意大利 Ivrea 一家高科技设计学校的老师。他的学生们经常抱怨找不到便宜好用的微控制器。2005年冬天， Massimo Banzi 跟David Cuartielles 讨论了这个问题。David Cuartielles 是一个西班牙籍芯片工程师，当时在这所学校做访问学者。两人决定设计自己的电路板，并引入了Banzi 的学生 David Mellis 为电路板设计编程语言。两天以后，David Mellis 就写出了程式码。又过了三天，电路板就完工了。这块电路板被命名为Arduino。几乎任何人，即使不懂电脑编程，也能用 Arduino 做出很酷的东西，比如对传感器作出回应，闪烁灯光，还能控制马达。

随后Banzi，Cuartielles，和Mellis把设计图放到了网上。版权法可以监管开源软件，却很难用在硬件上，为了保持设计的开放源码理念，他们决定采用Creative Commons(CC)的授权方式公开硬件设计图。在这样的授权下．任何人都可以生产电路板的复制品，甚至还能重新设计和销售原设计的复制品。人们不需要支付任何费用，甚至不用取得Arduino团队的许可。然而，如果重新发布了引用设计，就必须声明原始Arduino团队的贡献。如果修改了电路板，则最新设计必须使用相同或类似的Creative Commons(CC)的授权方式，以保证新版本的Arduino电路板也会一样是自由和开放的。唯一被保留的只有**Arduino**这个名字，它被注册成了商标，在没有官方授权的情况下不能使用它。Arduino发展至今，已经有了多种型号及众多衍生控制器推出。

![arduino_uno2](.\images\arduino_uno2.png)

#### Arduino特点

##### **跨平台**

​	Arduino IDE可以在Windows、Macintosh OS X、Linux三大主流操作系统上运行，而其他的大多数控制器只能在Windows上开发。

##### **简单清晰**

​	Arduino IDE基于**processing** IDE开发，processing 是MIT 开发的一款编程语言，目的是让艺术家也能够学会用程序来表达自己。对于初学者来说，极易掌握，同时有着足够的灵活性。Arduino语言基于c++语言开发，同时包含了大量的框架库，使用起来非常的简单。

##### **开放性**

​	Arduino的硬件原理图、电路图、IDE软件及核心库文件都是开源的，在开源协议范围内里可以任意修改原始设计及相应代码。

##### **发展迅速**

​	2012年笔者在**《机器人创新实验》**课程中采用Arduino进行教学，那时Arduino中文书籍jd搜索只有2部，现在(2016)已经可以搜索出近百种。而且Arduino UNO国产板的价格已经从当年60左右降到了现在的10来块，各个模块也都出现急剧降价，*说明Arduino的使用量在成倍的增加*。在中小学的教育中，Arudino的使用也如同雨后春笋般发展。因为Arduino的种种优势，越来越多的专业硬件开发者已经或开始使用Arduino来开发他们的项目、产品；越来越多的软件开发者使用Arduino进入硬件、物联网等开发领域；大学里，自动化、软件，甚至艺术专业，也纷纷开展了Arduino相关课程。

#### 推荐购买清单

​	动手操作是最好的学习方式，所以这里笔者根据多年教学经验，推荐了一份购买清单，大家可以根据自己情况进行选择性购买。这份清单是笔者教授**《机器人创新实验》**课程时对学生的建议，利用清单上的物品，大家可以做出**智能避障移动机器人**，**智能巡线移动机器人**，**智能温湿度采集器**等设备。

[arduino学习购买清单.docx](https://github.com/winxos/device_automation_from0to1/raw/master/arduino%E5%AD%A6%E4%B9%A0%E8%B4%AD%E4%B9%B0%E6%B8%85%E5%8D%95.docx)

> 注意：因商家原因，清单中的链接并不保证时效性，所以如果哪个链接失效了，请自行根据链接附带的图片重新寻找该物品。

### 常用执行元件

- 直流电机
- 步进电机
- 舵机
- 伺服电机
- 电磁铁

### 常用传感器

- 行程开关
- 环境温度传感器
- 热电阻传感器
- 霍尔传感器
- 红外接近传感器
- 超声波测距模块
- 悬臂梁称重模块

### 常用显示模块

- LED

LED一般用于指示灯，如利用闪烁频率的控制表示工作状态、故障情况，也可以用于信号传输（类似遥控器原理）。

- LED点阵

广告牌用的较多，有专用的控制器及整套解决方案，机电产品上使用较少。

- LCD2004/LCD2004 I2C

字符屏在产品中使用较多，根据需求有多种规格可以选择，常用的2004表示可以显示20 x 4的英文字符，12864 表示可以显示 128 x 64 个像素点。

![2004](.\images\2004.jpg)

![12864](.\images\12864.jpg)



- 段式液晶

![seg](.\images\seg.jpg)

- oled屏

![oled](.\images\oled.jpg)

- 串口屏

![serial_screen](.\images\serial_screen.jpg)

##中级篇 
### 微控制器主要厂商及产品系列

### 控制方案设计步骤

- 需求分析
- 微控制器选型
- 最小系统设计

### 时序图

![spi](.\images\spi.png)

### 驱动编写

读芯片手册

### 常用通讯协议

- UART
- I2C
- SPI

##提高篇

### 数据结构与算法设计

参考相关书籍

### 合作式调度器设计

常见程序框架

有什么问题？

适用范围？

解决办法?

### 大型项目文件管理

软件工程

设计模式

## 参考书目

| [![爱上Arduino（第2版）](http://img13.360buyimg.com/n7/g9/M03/07/19/rBEHaVBinhYIAAAAAABth9Z26j4AABhfgDej2QAAG2f523.jpg)](http://item.jd.com/11097323.html) | [![嵌入式系统设计与实践封面](http://img12.360buyimg.com/n1/s200x200_g15/M02/01/0F/rBEhWlG-lWcIAAAAAAG0Bz3i2l8AAASpgPA3ckAAbQf238.jpg)](http://item.jd.com/1626458326.html) | [![STM32库开发实战指南](http://img13.360buyimg.com/n1/s200x200_jfs/t2518/129/913544251/260698/70dee052/56724f82N2424d77c.jpg)](http://item.jd.com/11273708.html) | [![Altium Designer原理图与PCB设计（第3版）](http://img14.360buyimg.com/n1/s200x200_jfs/t2449/242/366990962/200888/fce5b759/56026964N0c89658b.jpg)](http://item.jd.com/11768609.html) |
| ---------------------------------------- | ---------------------------------------- | ---------------------------------------- | ---------------------------------------- |
| [![爱上Raspberry Pi（第2版）](http://img12.360buyimg.com/n1/s200x200_jfs/t2977/224/893238896/568923/ce46b408/576b521eNf7026833.jpg)](http://item.jd.com/11969202.html) | [![C Primer Plus 第6版 中文版](http://img12.360buyimg.com/n1/s200x200_jfs/t2851/14/1309443716/77855/47617a5e/573ab66eNe797b873.jpg)](http://item.jd.com/11917487.html) | [![现代软件工程：构建之法（第二版））](http://img13.360buyimg.com/n1/s200x200_jfs/t1954/1/1094687085/100921/ab2348f0/5670fe62Nd3989bbd.jpg)](http://item.jd.com/11733233.html) | [![数据结构与算法分析：C语言描述（原书第2版）](http://img11.360buyimg.com/n1/s200x200_15417/d3adcc21-09a4-4d66-8bed-d8c8ee04e684.jpg)](http://item.jd.com/10057441.html) |
| [![手把手教你学51单片机（C语言版）](http://img11.360buyimg.com/n1/s200x200_jfs/t2752/347/1392584966/124534/e099fb9c/573d6a19Nd42fe700.jpg)](http://item.jd.com/11446466.html) | [![Arduino权威指南（第2版）](http://img11.360buyimg.com/n1/s200x200_jfs/t1879/102/2821381138/124073/c6515806/56eb781eNf9d8fd19.jpg)](http://item.jd.com/11666296.html) | [![基于AVR单片机的控制系统设计](http://img13.360buyimg.com/n1/s200x200_jfs/t2392/310/1955170826/196834/29147518/56e65c88Nca67092d.jpg)](http://item.jd.com/11883948.html) |                                          |

